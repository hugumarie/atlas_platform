{% extends "platform/onboarding/base.html" %}

{% block title %}Objectifs Patrimoniaux - Étape 3/5{% endblock %}

{% block onboarding_content %}
<div class="onboarding-step" data-step="3">
    <div class="onboarding-header">
        <div class="onboarding-progress">
            <div class="onboarding-progress-bar" style="width: 60%;"></div>
        </div>
        <div class="onboarding-step-indicator">Étape 3 sur 5</div>
    </div>

    <div class="onboarding-content">
        <div class="onboarding-welcome">
            <h1>Vos objectifs patrimoniaux</h1>
            <p class="onboarding-subtitle">
                Quels sont vos principaux objectifs financiers ? Vous pouvez en sélectionner plusieurs.
            </p>
        </div>

        <form class="onboarding-form" id="objectivesForm">
            <div class="onboarding-choices">
                <div class="onboarding-choice">
                    <input type="checkbox" id="retirement" name="objectives[]" value="retirement" class="onboarding-choice-input">
                    <label for="retirement" class="onboarding-choice-label">
                        <div class="onboarding-choice-icon">
                            <i class="fas fa-umbrella"></i>
                        </div>
                        <div class="onboarding-choice-title">Préparer la retraite</div>
                        <div class="onboarding-choice-description">Constituer un complément de revenus pour maintenir votre niveau de vie</div>
                    </label>
                </div>

                <div class="onboarding-choice">
                    <input type="checkbox" id="property" name="objectives[]" value="property" class="onboarding-choice-input">
                    <label for="property" class="onboarding-choice-label">
                        <div class="onboarding-choice-icon">
                            <i class="fas fa-home"></i>
                        </div>
                        <div class="onboarding-choice-title">Acquérir un bien immobilier</div>
                        <div class="onboarding-choice-description">Financer l'achat de votre résidence principale ou d'un investissement locatif</div>
                    </label>
                </div>

                <div class="onboarding-choice">
                    <input type="checkbox" id="children" name="objectives[]" value="children" class="onboarding-choice-input">
                    <label for="children" class="onboarding-choice-label">
                        <div class="onboarding-choice-icon">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <div class="onboarding-choice-title">Financer les études</div>
                        <div class="onboarding-choice-description">Constituer un capital pour les études de vos enfants</div>
                    </label>
                </div>

                <div class="onboarding-choice">
                    <input type="checkbox" id="emergency" name="objectives[]" value="emergency" class="onboarding-choice-input">
                    <label for="emergency" class="onboarding-choice-label">
                        <div class="onboarding-choice-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="onboarding-choice-title">Épargne de précaution</div>
                        <div class="onboarding-choice-description">Constituer une réserve financière pour faire face aux imprévus</div>
                    </label>
                </div>

                <div class="onboarding-choice">
                    <input type="checkbox" id="growth" name="objectives[]" value="growth" class="onboarding-choice-input">
                    <label for="growth" class="onboarding-choice-label">
                        <div class="onboarding-choice-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="onboarding-choice-title">Faire fructifier mon capital</div>
                        <div class="onboarding-choice-description">Optimiser la performance de mes placements financiers</div>
                    </label>
                </div>

                <div class="onboarding-choice">
                    <input type="checkbox" id="tax" name="objectives[]" value="tax" class="onboarding-choice-input">
                    <label for="tax" class="onboarding-choice-label">
                        <div class="onboarding-choice-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <div class="onboarding-choice-title">Optimiser la fiscalité</div>
                        <div class="onboarding-choice-description">Réduire mes impôts grâce à des investissements défiscalisants</div>
                    </label>
                </div>

                <div class="onboarding-choice">
                    <input type="checkbox" id="transmission" name="objectives[]" value="transmission" class="onboarding-choice-input">
                    <label for="transmission" class="onboarding-choice-label">
                        <div class="onboarding-choice-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <div class="onboarding-choice-title">Préparer la transmission</div>
                        <div class="onboarding-choice-description">Organiser la transmission de mon patrimoine à mes héritiers</div>
                    </label>
                </div>

                <div class="onboarding-choice">
                    <input type="checkbox" id="project" name="objectives[]" value="project" class="onboarding-choice-input">
                    <label for="project" class="onboarding-choice-label">
                        <div class="onboarding-choice-icon">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <div class="onboarding-choice-title">Financer un projet</div>
                        <div class="onboarding-choice-description">Constituer un capital pour un projet personnel ou professionnel</div>
                    </label>
                </div>
            </div>

            <div class="onboarding-form-group" style="margin-top: 32px;">
                <label class="onboarding-label" for="horizon">Horizon de placement principal</label>
                <select class="onboarding-select" id="horizon" name="horizon" required>
                    <option value="">Sélectionnez votre horizon</option>
                    <option value="short">Court terme (moins de 3 ans)</option>
                    <option value="medium">Moyen terme (3 à 8 ans)</option>
                    <option value="long">Long terme (plus de 8 ans)</option>
                </select>
            </div>
        </form>
    </div>

    <div class="onboarding-actions">
        <a href="{{ url_for('platform_onboarding.profile') }}" class="onboarding-btn-back">
            <i class="fas fa-arrow-left"></i>
            <span>Retour</span>
        </a>
        
        <button type="button" class="onboarding-btn-next" id="nextBtn" disabled>
            <span>Continuer</span>
            <i class="fas fa-arrow-right"></i>
        </button>
    </div>
</div>
{% endblock %}

{% block onboarding_scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const step = document.querySelector('.onboarding-step');
    step.classList.add('animate-in');
    
    const form = document.getElementById('objectivesForm');
    const nextBtn = document.getElementById('nextBtn');
    const checkboxes = form.querySelectorAll('input[type="checkbox"]');
    const horizonSelect = document.getElementById('horizon');
    
    // Animation des choix
    const choices = document.querySelectorAll('.onboarding-choice');
    choices.forEach((choice, index) => {
        setTimeout(() => {
            choice.style.opacity = '1';
            choice.style.transform = 'translateY(0)';
        }, 200 + (index * 100));
    });
    
    // Validation du formulaire
    function validateForm() {
        const checkedBoxes = Array.from(checkboxes).filter(cb => cb.checked);
        const hasObjectives = checkedBoxes.length > 0;
        const hasHorizon = horizonSelect.value !== '';
        
        nextBtn.disabled = !(hasObjectives && hasHorizon);
    }
    
    // Écouter les changements
    checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', validateForm);
    });
    
    horizonSelect.addEventListener('change', validateForm);
    
    // Action du bouton suivant
    nextBtn.addEventListener('click', function() {
        if (!nextBtn.disabled) {
            // Sauvegarder les données
            const formData = new FormData(form);
            const objectives = formData.getAll('objectives[]');
            const horizon = formData.get('horizon');
            
            const data = {
                objectives: objectives,
                horizon: horizon
            };
            
            console.log('Objectives data:', data);
            
            // Rediriger vers l'étape suivante
            window.location.href = "{{ url_for('platform_onboarding.risk_profile') }}";
        }
    });
});
</script>
{% endblock %}